<include file="public/TK_top" />
<style>
/*	.around {
    width: 2.688rem;
    height: 2.688rem;
    overflow: hidden;
    -moz-border-radius: 50%;
    -webkit-border-radius: 50%;
    border-radius: 50%;
    margin-top: .42667rem
}*/

/* .around img {
    vertical-align: inherit;
    width: 2.688rem;
    height: 2.688rem
}*/

.close {
    margin: .42667rem .64rem
}
.close a {
    display: block;
    background: #ff4401;
    text-align: center;
    width: 100%;
    height: 1.87733rem;
    color: #fff;
    line-height: 1.87733rem;
    font-size: .64rem;
    -moz-border-radius: .42667rem;
    -webkit-border-radius: .42667rem;
    border-radius: .42667rem
}
.e-toux{ border-radius:100%; -webkit-border-radius:100%; -moz-border-radius:100%; overflow:hidden}
.e-toux, .e-toux img{ width:2.68rem; height:2.68rem;}
</style>
<div class="e-zil">
	<ul>
		
		
		<li>
			<div class="bt fl">更换头像</div>
			<div class="nei fl around">
			<form id="head_pic" method="post" action="{:U('/Member/Profile/set_pic')}" class="e-toux" enctype="multipart/form-data">
			<label id="fileList">
				<img id="preview" src="{$staff_info.head_pic|default='__STATIC__/images/headPic.jpg'}"/>
				<input  type="file" accept="image/*" name="head_pic"  onchange="handleFiles(this)" style="display:none">
			<input type="hidden" name="head_pic" id="head_pic" value="{$user.head_pic}">
			</label>
			</form>
			</div>
		</li>
		
		<script>
		//显示上传照片
window.URL = window.URL || window.webkitURL;
function handleFiles(obj) {
    fileList = document.getElementById("fileList");
    var files = obj.files;
    img = new Image();
    if(window.URL){
        img.src = window.URL.createObjectURL(files[0]); //创建一个object URL，并不是你的本地路径
        img.width = 60;
        img.height = 60;
        img.onload = function(e) {
            window.URL.revokeObjectURL(this.src); //图片加载后，释放object URL
        }
        if(fileList.firstElementChild){
            fileList.removeChild(fileList.firstElementChild);
        }
        $('#fileList').find('img').remove();
        fileList.appendChild(img);
    }else if(window.FileReader){
        //opera不支持createObjectURL/revokeObjectURL方法。我们用FileReader对象来处理
        var reader = new FileReader();
        reader.readAsDataURL(files[0]);
        reader.onload = function(e){
            img.src = this.result;
            img.width = 60;
            img.height = 60;
            $('#fileList').find('img').remove();
            fileList.appendChild(img);
        }
    }else
    {
        //ie
        obj.select();
        obj.blur();
        var nfile = document.selection.createRange().text;
        document.selection.empty();
        img.src = nfile;
        img.width = 60;
        img.height = 60;
        img.onload=function(){

        }
        $('#fileList').find('img').remove();
        fileList.appendChild(img);
    }
    $('#asubmit').show();
    $('#logout').hide();
    $('#head_pic').submit();
}
		</script>
		
		<li>
			<div class="bt fl">
				真实姓名
		    </div>
			<div class="nei fl">
				{$staff_info.real_name}
			</div>
		</li>
		<li>
			<div class="bt fl">
				手机号码
		    </div>
			<div class="nei fl">
				{$staff_info.phone}<a href="{:U('/Member/Profile/set_phone')}">换绑手机</a>
			</div>
		</li>
		<li>
			<div class="bt fl">
				身份证号
		    </div>
			<div class="nei fl">
				<if condition="$staff_info.id_code">{$staff_info.id_code|substr=0,14}****</if>&nbsp;
			</div>
		</li>
		<li>
			<div class="bt fl">
				详细地址
		    </div>
			<div class="nei fl">
				{$staff_info.address}&nbsp;
			</div>
		</li>
		
		<li class="close">
			<a href="{:U('/Member/System/logout')}" id="logout">安全退出</a>
			<a id="asubmit" style="display:none;" href="javascript:;" onclick="javascript:$('#head_pic').submit();">保存头像</a>
		</li >
	</ul>
</div>                        
</body>
</html>